<div [@routerTransition]>
    <div class="kt-content  kt-grid__item kt-grid__item--fluid kt-grid kt-grid--hor">
        <div class="kt-subheader kt-grid__item">
            <div [class]="containerClass">
                <div class="input-group col-md-3 col-sm-12 col-lg-6">
                    <input [(ngModel)]="filterText" name="filterText" autoFocus class="form-control m-input"
                           [placeholder]="l('SearchWithThreeDot')" type="text"/>
                    <span class="input-group-btn">
                        <button (click)="getPbEbooks()" class="btn btn-primary" type="submit"><i
                            class="flaticon-search-1"></i></button>
                    </span>
                </div>
                <div class="kt-subheader__toolbar">
                    <div class="kt-subheader__wrapper">
                        <button (click)="advancedFiltersAreShown=!advancedFiltersAreShown"
                                class="btn btn-outline-success"><i class="fa fa-file-excel"></i> Tìm kiếm nâng cao
                        </button>
                        <button *ngIf="isGranted('Pages.PbEbooks.Create')" (click)="createPbEbook()"
                                class="btn btn-primary blue"><i class="fa fa-plus"></i> Tạo mới sách
                        </button>
                    </div>
                </div>
            </div>
        </div>
        <div [class]="containerClass + ' kt-grid__item kt-grid__item--fluid'">
            <div class="kt-portlet kt-portlet--mobile">
                <div class="kt-portlet__body">
                    <div class="row">
                        <div class="col-md-10 col-sm-12">
                            <p-sidebar [(visible)]="advancedFiltersAreShown" position="left">
                                <div class="row">
                                    <p-scrollPanel [style]="{width: '100%',height: '500px'}" styleClass="custombar2">
                                        <div class="col-md-10">
                                            <div class="kt-separator kt-separator--border-dashed"></div>
                                        </div>
                                        <div class="col-md-10">
                                            <div class="form-group">
                                                <label for="EbookNameFilter">Tên sách</label>
                                                <input type="text" class="form-control" id="EbookNameFilter"
                                                       name="ebookNameFilter" [(ngModel)]="ebookNameFilter">
                                            </div>
                                        </div>
                                        <div class="col-md-10">
                                            <div class="form-group">
                                                <label
                                                    for="MinEbookDateStartFilter">{{l("EbookDateStartRange")}}</label>
                                                <div class="input-group">
                                                    <input class="form-control m-input" id="MinEbookDateStartFilter"
                                                           name="MinEbookDateStartFilter" type="datetime" bsDatepicker
                                                           placeholder="{{l('MinValue')}}"
                                                           [(ngModel)]="minEbookDateStartFilter">
                                                    <span
                                                        style="line-height: 40px;padding: 0 15px 0 15px;"> &mdash; </span>
                                                    <input class="form-control m-input" id="MaxEbookDateStartFilter"
                                                           name="MaxEbookDateStartFilter" type="datetime" bsDatepicker
                                                           placeholder="{{l('MaxValue')}}"
                                                           [(ngModel)]="maxEbookDateStartFilter">
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-10">
                                            <label for="ProFilterSelect">{{l("Pro")}}</label>
                                            <select class="form-control" name="ProFilter" id="ProFilterSelect"
                                                    [(ngModel)]="proFilter">
                                                <option value="-1">{{l("All")}}</option>
                                                <option value="0">{{l("False")}}</option>
                                                <option value="1">{{l("True")}}</option>
                                            </select>
                                        </div>
                                        <div *ngIf="proFilter==1" class="col-md-10">
                                            <div class="form-group">
                                                <label
                                                    for="MinEbookPriceFilter">{{l("MinMax")}} {{l("EbookPrice")}}</label>
                                                <div class="input-group">
                                                    <input type="number" class="form-control" id="MinEbookPriceFilter"
                                                           [(ngModel)]="minEbookPriceFilter"
                                                           placeholder="{{l('MinValue')}}"
                                                           name="minEbookPriceFilter"/>
                                                    <input type="number" class="form-control"
                                                           [(ngModel)]="maxEbookPriceFilter"
                                                           placeholder="{{l('MaxValue')}}"
                                                           name="maxEbookPriceFilter"/>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-10">
                                            <div class="form-group">
                                                <label for="DiscriptionFilter">{{l("Discription")}}</label>
                                                <input type="text" class="form-control" id="DiscriptionFilter"
                                                       name="discriptionFilter" [(ngModel)]="discriptionFilter">
                                            </div>
                                        </div>
                                        <div class="col-md-10">
                                            <div class="form-group">
                                                <label for="UserNameFilter">({{l("User")}}) {{l("Name")}}</label>
                                                <input type="text" class="form-control" id="UserNameFilter"
                                                       name="userNameFilter" [(ngModel)]="userNameFilter">
                                            </div>
                                        </div>
                                        <div class="col-md-10">
                                            <div class="form-group">
                                                <label for="PbClassClassNameFilter">({{l("PbClass")}}
                                                    ) {{l("ClassName")}}</label>
                                                <input type="text" class="form-control" id="PbClassClassNameFilter"
                                                       name="pbClassClassNameFilter"
                                                       [(ngModel)]="pbClassClassNameFilter">
                                            </div>
                                        </div>
                                        <div class="col-md-10">
                                            <div class="form-group">
                                                <label for="PbPlacePlaceNameFilter">({{l("PbPlace")}}
                                                    ) {{l("PlaceName")}}</label>
                                                <input type="text" class="form-control" id="PbPlacePlaceNameFilter"
                                                       name="pbPlacePlaceNameFilter"
                                                       [(ngModel)]="pbPlacePlaceNameFilter">
                                            </div>
                                        </div>
                                        <div class="col-md-10">
                                            <div class="form-group">
                                                <label for="PbStatusStatusNameFilter">({{l("PbStatus")}}
                                                    ) {{l("StatusName")}}</label>
                                                <input type="text" class="form-control" id="PbStatusStatusNameFilter"
                                                       name="pbStatusStatusNameFilter"
                                                       [(ngModel)]="pbStatusStatusNameFilter">
                                            </div>
                                        </div>
                                        <div class="col-md-10">
                                            <div class="form-group">
                                                <label
                                                    for="PbSubjectEducationSubjectNameFilter">({{l("PbSubjectEducation")}}
                                                    ) {{l("SubjectName")}}</label>
                                                <input type="text" class="form-control"
                                                       id="PbSubjectEducationSubjectNameFilter"
                                                       name="pbSubjectEducationSubjectNameFilter"
                                                       [(ngModel)]="pbSubjectEducationSubjectNameFilter">
                                            </div>
                                        </div>
                                        <div class="col-md-10">
                                            <div class="form-group">
                                                <label for="PbTypeEbookTypeNameFilter">({{l("PbTypeEbook")}}
                                                    ) {{l("TypeName")}}</label>
                                                <input type="text" class="form-control" id="PbTypeEbookTypeNameFilter"
                                                       name="pbTypeEbookTypeNameFilter"
                                                       [(ngModel)]="pbTypeEbookTypeNameFilter">
                                            </div>
                                        </div>
                                        <div class="col-md-10">
                                            <div class="form-group">
                                                <label for="PbTypeFileTypeFileNameFilter">({{l("PbTypeFile")}}
                                                    ) {{l("TypeFileName")}}</label>
                                                <input type="text" class="form-control"
                                                       id="PbTypeFileTypeFileNameFilter"
                                                       name="pbTypeFileTypeFileNameFilter"
                                                       [(ngModel)]="pbTypeFileTypeFileNameFilter">
                                            </div>
                                        </div>
                                    </p-scrollPanel>
                                </div>
                            </p-sidebar>
                            <div class="row align-items-center">
                                <!--<Primeng-Datatable-Start>-->
                                <div class="primeng-datatable-container col-12"
                                     [busyIf]="primengTableHelper.isLoading">
                                    <p-table #dataTable
                                             (onLazyLoad)="getPbEbooks($event)"
                                             [value]="primengTableHelper.records"
                                             rows="{{primengTableHelper.defaultRecordsCountPerPage}}"
                                             [paginator]="false"
                                             [lazy]="true"
                                             [scrollable]="true"
                                             ScrollWidth="100%"
                                             [responsive]="primengTableHelper.isResponsive"
                                             [resizableColumns]="primengTableHelper.resizableColumns">
                                        <ng-template pTemplate="header">
                                            <tr>
                                                <th style="width: 130px"
                                                    [hidden]="!isGrantedAny('Pages.PbEbooks.Edit', 'Pages.PbEbooks.Delete')">{{l('Actions')}}</th>
                                                <th style="width: 150px" pSortableColumn="userFk.name">
                                                    {{l('Name')}}
                                                    <p-sortIcon field="userName"></p-sortIcon>
                                                </th>
                                                <th style="width: 150px" pSortableColumn="pbClassFk.className">
                                                    {{l('ClassName')}}
                                                    <p-sortIcon field="pbClassClassName"></p-sortIcon>
                                                </th>
                                                <th style="width: 150px" pSortableColumn="pbPlaceFk.placeName">
                                                    {{l('PlaceName')}}
                                                    <p-sortIcon field="pbPlacePlaceName"></p-sortIcon>
                                                </th>
                                                <th style="width: 150px" pSortableColumn="pbRankFk.rankName">
                                                    {{l('RankName')}}
                                                    <p-sortIcon field="pbRankRankName"></p-sortIcon>
                                                </th>
                                                <th style="width: 150px" pSortableColumn="pbStatusFk.statusName">
                                                    {{l('StatusName')}}
                                                    <p-sortIcon field="pbStatusStatusName"></p-sortIcon>
                                                </th>
                                                <th style="width: 150px" pSortableColumn="pbSubjectFk.sectionName">
                                                    {{l('SectionName')}}
                                                    <p-sortIcon field="pbSubjectSectionName"></p-sortIcon>
                                                </th>
                                                <th style="width: 150px"
                                                    pSortableColumn="pbSubjectEducationFk.subjectName">
                                                    {{l('SubjectName')}}
                                                    <p-sortIcon field="pbSubjectEducationSubjectName"></p-sortIcon>
                                                </th>
                                                <th style="width: 150px" pSortableColumn="pbTypeEbookFk.typeName">
                                                    {{l('TypeName')}}
                                                    <p-sortIcon field="pbTypeEbookTypeName"></p-sortIcon>
                                                </th>
                                                <th style="width: 150px" pSortableColumn="pbTypeFileFk.typeFileName">
                                                    {{l('TypeFileName')}}
                                                    <p-sortIcon field="pbTypeFileTypeFileName"></p-sortIcon>
                                                </th>
                                                <th style="width: 150px" pSortableColumn="ebookName">
                                                    {{l('EbookName')}}
                                                    <p-sortIcon field="pbEbook.ebookName"></p-sortIcon>
                                                </th>
                                                <th style="width: 150px" pSortableColumn="link">
                                                    {{l('Link')}}
                                                    <p-sortIcon field="pbEbook.link"></p-sortIcon>
                                                </th>
                                                <th style="width: 150px" pSortableColumn="ebookDateStart">
                                                    {{l('EbookDateStart')}}
                                                    <p-sortIcon field="pbEbook.ebookDateStart"></p-sortIcon>
                                                </th>
                                                <th style="width: 150px" pSortableColumn="pro">
                                                    {{l('Pro')}}
                                                    <p-sortIcon field="pbEbook.pro"></p-sortIcon>
                                                </th>
                                                <th style="width: 150px" pSortableColumn="linkPro">
                                                    {{l('LinkPro')}}
                                                    <p-sortIcon field="pbEbook.linkPro"></p-sortIcon>
                                                </th>
                                                <th style="width: 150px" pSortableColumn="ebookPrice">
                                                    {{l('EbookPrice')}}
                                                    <p-sortIcon field="pbEbook.ebookPrice"></p-sortIcon>
                                                </th>
                                                <th style="width: 150px" pSortableColumn="ebookView">
                                                    {{l('EbookView')}}
                                                    <p-sortIcon field="pbEbook.ebookView"></p-sortIcon>
                                                </th>
                                                <th style="width: 150px" pSortableColumn="ebookLike">
                                                    {{l('EbookLike')}}
                                                    <p-sortIcon field="pbEbook.ebookLike"></p-sortIcon>
                                                </th>
                                                <th style="width: 150px" pSortableColumn="ebookDislike">
                                                    {{l('EbookDislike')}}
                                                    <p-sortIcon field="pbEbook.ebookDislike"></p-sortIcon>
                                                </th>
                                                <th style="width: 150px" pSortableColumn="discription">
                                                    {{l('Discription')}}
                                                    <p-sortIcon field="pbEbook.discription"></p-sortIcon>
                                                </th>
                                                <th style="width: 150px" pSortableColumn="ebookCover">
                                                    {{l('EbookCover')}}
                                                    <p-sortIcon field="pbEbook.ebookCover"></p-sortIcon>
                                                </th>

                                            </tr>
                                        </ng-template>
                                        <ng-template pTemplate="body" let-record="$implicit">
                                            <tr>
                                                <td style="width: 130px"
                                                    [hidden]="!isGrantedAny('Pages.PbEbooks.Edit', 'Pages.PbEbooks.Delete')">
                                                    <div class="btn-group dropdown" dropdown container="body">
                                                        <button class="dropdown-toggle btn btn-sm btn-primary"
                                                                dropdownToggle>
                                                            <i class="fa fa-cog"></i><span
                                                            class="caret"></span> {{l("Actions")}}
                                                        </button>
                                                        <ul class="dropdown-menu" *dropdownMenu>
                                                            <li>
                                                                <a href="javascript:;"
                                                                   (click)="viewPbEbookModal.show(record)">{{l('View')}}</a>
                                                            </li>
                                                            <li>
                                                                <a href="javascript:;"
                                                                   *ngIf="permission.isGranted('Pages.PbEbooks.Edit')"
                                                                   (click)="createOrEditPbEbookModal.show(record.pbEbook.id)">{{l('Edit')}}</a>
                                                            </li>
                                                            <li>
                                                                <a href="javascript:;"
                                                                   *ngIf="permission.isGranted('Pages.PbEbooks.Delete')"
                                                                   (click)="deletePbEbook(record.pbEbook)">{{l('Delete')}}</a>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </td>
                                                <td style="width:150px">
                                                    <span class="ui-column-title"> {{l('Name')}}</span>
                                                    {{record.userName}}
                                                </td>
                                                <td style="width:150px">
                                                    <span class="ui-column-title"> {{l('ClassName')}}</span>
                                                    {{record.pbClassClassName}}
                                                </td>
                                                <td style="width:150px">
                                                    <span class="ui-column-title"> {{l('PlaceName')}}</span>
                                                    {{record.pbPlacePlaceName}}
                                                </td>
                                                <td style="width:150px">
                                                    <span class="ui-column-title"> {{l('RankName')}}</span>
                                                    {{record.pbRankRankName}}
                                                </td>
                                                <td style="width:150px">
                                                    <span class="ui-column-title"> {{l('StatusName')}}</span>
                                                    {{record.pbStatusStatusName}}
                                                </td>
                                                <td style="width:150px">
                                                    <span class="ui-column-title"> {{l('SectionName')}}</span>
                                                    {{record.pbSubjectSectionName}}
                                                </td>
                                                <td style="width:150px">
                                                    <span class="ui-column-title"> {{l('SubjectName')}}</span>
                                                    {{record.pbSubjectEducationSubjectName}}
                                                </td>
                                                <td style="width:150px">
                                                    <span class="ui-column-title"> {{l('TypeName')}}</span>
                                                    {{record.pbTypeEbookTypeName}}
                                                </td>
                                                <td style="width:150px">
                                                    <span class="ui-column-title"> {{l('TypeFileName')}}</span>
                                                    {{record.pbTypeFileTypeFileName}}
                                                </td>
                                                <td style="width:150px">
                                                    <span class="ui-column-title"> {{l('EbookName')}}</span>
                                                    {{record.pbEbook.ebookName}}
                                                </td>
                                                <td style="width:150px">
                                                    <span class="ui-column-title"> {{l('Link')}}</span>
                                                    {{record.pbEbook.link}}
                                                </td>
                                                <td style="width:150px">
                                                    <span class="ui-column-title"> {{l('EbookDateStart')}}</span>
                                                    <span *ngIf="record.pbEbook.ebookDateStart">
											{{record.pbEbook.ebookDateStart | momentFormat:'L'}}
                                        </span>
                                                    <span *ngIf="!record.pbEbook.ebookDateStart">-</span>
                                                </td>
                                                <td style="width:150px">
                                                    <span class="ui-column-title"> {{l('Pro')}}</span>
                                                    <div *ngIf="record.pbEbook.pro" class="text-center"><i
                                                        class="fa fa-check-circle kt--font-success" title="True"></i>
                                                    </div>
                                                    <div *ngIf="!record.pbEbook.pro" class="text-center"><i
                                                        class="fa fa-times-circle" title="False"></i></div>
                                                </td>
                                                <td style="width:150px">
                                                    <span class="ui-column-title"> {{l('LinkPro')}}</span>
                                                    {{record.pbEbook.linkPro}}
                                                </td>
                                                <td style="width:150px">
                                                    <span class="ui-column-title"> {{l('EbookPrice')}}</span>
                                                    {{record.pbEbook.ebookPrice}}
                                                </td>
                                                <td style="width:150px">
                                                    <span class="ui-column-title"> {{l('EbookView')}}</span>
                                                    {{record.pbEbook.ebookView}}
                                                </td>
                                                <td style="width:150px">
                                                    <span class="ui-column-title"> {{l('EbookLike')}}</span>
                                                    {{record.pbEbook.ebookLike}}
                                                </td>
                                                <td style="width:150px">
                                                    <span class="ui-column-title"> {{l('EbookDislike')}}</span>
                                                    {{record.pbEbook.ebookDislike}}
                                                </td>
                                                <td style="width:150px">
                                                    <span class="ui-column-title"> {{l('Discription')}}</span>
                                                    {{record.pbEbook.discription}}
                                                </td>
                                                <td style="width:150px">
                                                    <span class="ui-column-title"> {{l('EbookCover')}}</span>
                                                    {{record.pbEbook.ebookCover}}
                                                </td>

                                            </tr>
                                        </ng-template>
                                    </p-table>
                                    <div class="primeng-no-data" *ngIf="primengTableHelper.totalRecordsCount == 0">
                                        {{l('NoData')}}
                                    </div>
                                    <div class="primeng-paging-container">
                                        <p-paginator [rows]="primengTableHelper.defaultRecordsCountPerPage"
                                                     #paginator
                                                     (onPageChange)="getPbEbooks($event)"
                                                     [totalRecords]="primengTableHelper.totalRecordsCount"
                                                     [rowsPerPageOptions]="primengTableHelper.predefinedRecordsCountPerPage">
                                        </p-paginator>
                                        <span class="total-records-count">
                                {{l('TotalRecordsCount', primengTableHelper.totalRecordsCount)}}
                            </span>
                                    </div>
                                </div>
                                <!--<Primeng-Datatable-End>-->
                            </div>
                            <div class="row">
                                <div class="col-md-2">
                                    <p-card>
                                        <p-header>
                                            <img src="Card" src="" style="height: '90%'">
                                        </p-header>
                                    </p-card>

                                </div>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <p-tabView>
                                <p-tabPanel header="Xem nhiều">
                                    Content 1
                                </p-tabPanel>
                            </p-tabView>
                            <p-tabView>
                                <p-tabPanel header="Mới nhất">
                                    Content 1
                                </p-tabPanel>
                            </p-tabView>
                            <p-tabView>
                                <p-tabPanel header="Tuyển tập">
                                    Content 1
                                </p-tabPanel>
                            </p-tabView>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <createOrEditPbEbookModal #createOrEditPbEbookModal (modalSave)="getPbEbooks()"></createOrEditPbEbookModal>
        <viewPbEbookModal #viewPbEbookModal></viewPbEbookModal>

    </div>
</div>
